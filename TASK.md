# **Проект 2.** Веб-сервис по предсказанию неблагоприятных погодных условий для путешественников

Путешественники сталкиваются с непредсказуемыми погодными условиями, которые могут повлиять на их планы. Возможность заранее узнать о плохих погодных условиях позволит более эффективно планировать поездки. Возможно, таким образом ты сможешь спроектировать свой веб-сервис, который будешь использовать потом сам или поделишься им с друзьями!

<!-- В рамках проекта ты изучишь основы работы с API, разработку веб-приложений на Flask, визуализацию данных с помощью Plotly и создание интерактивных интерфейсов с использованием Dash.  -->

**Цель.** Разработать веб-сервис, который предсказывает вероятность неблагоприятных погодных условий для заданного маршрута с использованием погодных данных от AccuWeather API. Сервис должен предоставлять пользователю удобные визуализации и прогнозы погоды для разных точек маршрута и временных интервалов.


**Основные задачи проекта**
- Настроить рабочее окружение и установить необходимые библиотеки для работы с Flask и API.
- Подключиться к AccuWeather API для получения актуальных данных о погоде.
- Разработать модель для определения неблагоприятных погодных условий на основе параметров погоды.
<!-- - Создать веб-интерфейс с использованием Flask для ввода маршрута и отображения погодных данных. -->
<!-- - Визуализировать погодные данные в виде интерактивных графиков с использованием Plotly и предоставить пользователю возможность выбора временных интервалов прогноза. -->
- Реализовать тестирование веб-сервиса с различными маршрутами и продумать возможные пути оптимизации (обработка ошибок, дополнительные функции для улучшения пользовательского опыта).


Проект реализуется на данных [AccuWeather](https://developer.accuweather.com/accuweather-forecast-api/apis).
<!--
*Если любопытно, то подробнее о создании веб-сервисов с использованием Flask, Plotly и Dash можно почитать [тут](https://towardsdatascience.com/embed-multiple-dash-apps-in-flask-with-microsoft-authenticatio-44b734f74532), также полезно будет почитать форум [здесь](https://community.plotly.com/t/how-to-integrate-the-plotly-dash-with-the-flask-app-how-to-connect-them/59842), а если очень хочется, то можно посмотреть на то, как интегрировать это все дело в Jupyter-ноутбуки в [этом](https://github.com/plotly/jupyter-dash) репозитории.* -->

## Формат сдачи проекта

<!-- Аналитики данных не только находят инсайты, но и умеют их доносить.  -->
Чтобы результаты работы были понятны другим (коллегам, заказчикам или даже просто тебе через месяц), придерживайся следующих правил оформления.

<!-- Правильное оформление ноутбука — это твой инструмент, чтобы идеи и результаты были понятны другим, будь то коллеги, заказчики или даже ты сам через пару месяцев. -->
Поэтому оформи проект в отдельном ноутбуке и используй эти принципы:
* Оформи проект в отдельном ноутбуке или проектов в IDE.

* Разделяй проект на логичные блоки с помощью заголовков.

* Перед каждым блоком кода добавляй краткое описание, которое объясняет:
  - что ты собираешься сделать,
  - зачем это нужно.

* Всегда добавляй комментарии к коду.

<!-- * В конце добавь раздел с выводами. В нём нужно кратко описать ключевые инсайты и результаты твоего анализа. -->

<!-- 1. **Заголовки**: четко разделяй проект на логичные блоки с помощью заголовков. Это поможет легко ориентироваться в содержании и понимать, о чем каждый раздел.

2. **Описание**: перед каждым блоком кода добавляй краткое описание, которое объясняет, что ты собираешься сделать и зачем это нужно. Это помогает лучше понять ход анализа. -->

<!-- 3. **Комментарии к коду**: всегда добавляй комментарии к коду. Это позволит любому человеку, включая тебя самого в будущем, быстро понять, что делает каждая строка или блок кода.

4. **Выводы**: не забудь выделить раздел для выводов. Здесь нужно кратко описать ключевые инсайты и результаты, которые ты нашел в ходе анализа. Это поможет закрепить основные моменты и подвести итоги работы. -->

## Оценивание проекта

Проект оценивается преподавателем на основе критериев, которые указаны под каждым заданием. Баллы за выполнение всех заданий суммируются и конвертируются в итоговую оценку по **10-балльной** шкале.

Максимальное количество баллов за проект — **100 баллов**

Таблица конвертации 100-бальной оценки в 10-бальную шкалу:

| Баллы | Оценка |
|----------------------------|---------------------------|
| 91-100                      | 10                        |
| 81-90                       | 9                         |
| 71-80                       | 8                         |
| 61-70                       | 7                         |
| 51-60                       | 6                         |
| 41-50                       | 5                         |
| 31-40                       | 4                         |
| 21-30                       | 3                         |
| 11-20                       | 2                         |
| 1-10                        | 1                         |
| 0                           | 0                         |


## Настройка окружения и подключение к API AccuWeather и получение данных о погоде

Для создания веб-сервиса, который будет предсказывать погодные условия по маршруту, первым шагом является получение данных о погоде с помощью AccuWeather API.


<!-- **Что нужно сделать:** -->

1. Зарегистрируйся на [AccuWeather API](https://developer.accuweather.com/) и получи свой API ключ.
2. Установи необходимые библиотеки: Flask, requests. Убедись, что Flask работает корректно и можно запустить простейший веб-сервис.
3. С помощью Python библиотеки `requests` сделай запрос к API для получения данных о погоде по заданным координатам (широта и долгота).
4. Преобразуй полученные данные в удобный формат (например, JSON), чтобы можно было работать с ними дальше.
5. Сохрани ключевые параметры прогноза погоды:

	- Температура в градусах Цельсия,

  - Влажность (процентное содержание),

  - Скорость ветра,

  - Вероятность дождя в процентах и др.

<!--

**Ответь на вопросы**
1. Почему важно проверить корректную работу простого веб-сервиса перед дальнейшим развитием проекта?
2. Какие погодные параметры наиболее важны для определения неблагоприятных условий для путешественников? Почему ты выбрал именно такие параметры?
3. Какой формат данных предоставляет AccuWeather API, и как ты будешь работать с этими данными в своем проекте? Как ты понимаешь, что такое процесс получения данных по API ключу? -->


### **Критерии оценки**

1. **Получение API ключа и установка библиотек — 4 балла:**
   - Студент успешно зарегистрировался и получил API ключ.
   - Нет ошибок при получении доступа к API.
   - Все необходимые библиотеки установлены без ошибок.

2. **Использование библиотеки `requests` для запроса данных — 8 баллов:**
   - Студент правильно использовал библиотеку для отправки HTTP-запросов к API.
   - Полученные данные корректно загружены в Python.

3. **Преобразование данных в читабельный формат — 6 баллов:**
   - Полученные данные успешно преобразованы в JSON или другой структурированный формат.
   - Данные представлены в удобном для дальнейшего анализа виде.

5. **Дополнительные критерии (опционально, +2 балла):**
   - Студент использовал дополнительные методы для проверки API (например, тестовые запросы на другие точки).
   - Оформление кода и результатов выполнено с применением хороших практик (документация, комментарии).

Максимальный балл, который можно получить за задание — **20 баллов.**

## Разработка модели оценки неблагоприятных погодных условий

Для создания полезного веб-сервиса важно определить критерии, по которым погодные условия могут считаться неблагоприятными для путешественников. Это задание предполагает разработку логики, которая будет классифицировать погодные условия как "хорошие" или "неблагоприятные" на основе различных метеорологических параметров.


**Что необходимо сделать:**
- Определи ключевые метеорологические параметры, которые определяют неблагоприятные погодные условия.
- Разработай простую логику, которая будет определять, когда погодные условия считаются неблагоприятными. Пример логики:

  - Температура ниже 0°C или выше 35°C,

  - Скорость ветра выше 50 км/ч,

  - Вероятность осадков выше 70%.

- Реализуй модель в виде функции, которая принимает на вход параметры погоды (температура, ветер, осадки) и возвращает результат: неблагоприятные или благоприятные условия. Учитывай, что
  - Модель оценки, которую ты разработал (например, функция `check_bad_weather`), должна быть вызвана каждый раз, когда пользователь вводит маршрут (начальные и конечные точки).
  - Обработчик запросов в Flask использует данные из API для передачи в модель. То есть когда пользователь отправляет запрос, сервер получает прогноз погоды через API, передает его в модель для анализа, а затем возвращает результат пользователю через веб-интерфейс.
- Проверка модели:
  - Проведи проверки работосопосбности модели с крайними значениями (например, очень низкая или очень высокая температура), чтобы убедиться, что модель корректно обрабатывает такие случаи.
  - Подумай, можно ли улучшить логику модели. Например, можно добавить дополнительные параметры (влажность, атмосферное давление) или настроить более сложные правила.



<!-- **Ответь на вопросы:**

1. Какие погодные параметры чаще всего считаются неблагоприятными для путешествий?
2. Как лучше всего выбрать пороговые значения для этих параметров?
3. Какие есть пути для улучшения модели, чтобы она более точно отражала реальные погодные условия? -->


### **Критерии оценки**

1. **Определение ключевых метеорологических параметров — 8 баллов:**
   - Параметры корректно выделены.

2. **Разработка логики оценки — 7 баллов:**

   - Разработана корректная пороговая логика для классификации погодных условий.

3. **Реализация модели — 10 баллов:**

   - Логика успешно интегрирована в код, пользователь получает корректную оценку погодных условий на основе введенных данных.

4. **Проверка - 5 баллов:**

  - Модель проверена и не выдает ошибок.

  - Проверка охватывает крайние случаи (очень холодная или жаркая погода, сильный ветер и осадки и тд).

<!-- 5. **Ответы на вопросы - 3 балла:**

  - Обоснована важность ключевых погодных параметров.
  
  - Пороговая логика описана и объяснена.
  
  - Приведены предложения по улучшению модели оценки. -->


Максимальный балл, который можно получить за задание — **30 баллов.**

## Разработка веб-интерфейса на Flask

На этом этапе мы создаём веб-интерфейс, через который пользователи смогут вводить начальную и конечную точки маршрута и получать данные о погодных условиях по заданным координатам.

**Что нужно сделать:**

- Создай HTML-форму с полями для ввода начальной и конечной точки маршрута (например, названия городов).
<!-- - Добавь  валидацию данных с помощью `WTForms` (например, проверка, что введены реальные города и текстовые значения корректны). -->
- Реализуй обработку POST-запросов через Flask: когда пользователь вводит данные в форму и нажимает кнопку, сервер должен получить данные и передать их для дальнейшей обработки.
- Обработай данные, введённые пользователем (например, названия городов), и отправь их в модель оценки погодных условий.
- Получи погодные данные с API и передай их в модель оценки погодных условий (из Задания 3), чтобы оценить, являются ли условия неблагоприятными.
- Отображай результаты оценки (например, текстом: "Погода супер" или "Ой-ой, погода плохая") на новой странице или обновляй текущую страницу после отправки формы.
- Реализуй удобный и понятный интерфейс для отображения этих данных пользователю.

*Если запрос к API не удался или произошла ошибка (например, неправильные координаты), необходимо обработать такие случаи и выдать пользователю сообщение о том, что данные недоступны. Для этого можно использовать `try-except` блоки в Python для обработки исключений при вызове API или передачи данных в модель.*


### **Критерии оценки**

1. **Создание HTML-формы — 10 баллов:**
	- Форма корректно разработана и позволяет пользователю вводить начальную и конечную точки.
	- Форма включает базовую валидацию данных.
2. **Настройка обработки данных — 10 баллов:**
	- Обработчик POST-запросов работает корректно, данные передаются на сервер и обрабатываются.
	- Данные вводятся, валидируются и передаются на сервер без ошибок.
3. **Интеграция модели — 10 баллов:**
	- Модель оценки погодных условий корректно интегрирована в веб-приложение.
	- Результаты работы модели (оценка погодных условий) отображаются в удобной и понятной форме.
	- Интерфейс веб-страницы аккуратен и понятен для пользователя.

Максимальный балл за задание — **30 баллов.**


## Тестирование и обработка ошибок

В этом задании мы сфокусируемся на тестировании веб-сервиса и реализации обработки возможных ошибок, которые могут возникнуть при вводе данных или взаимодействии с API.

**Что нужно сделать**:

- Протестируй работу всех компонентов веб-сервиса с разными данными (например, те, что ты уже использовал ранее, когда проверял корректные и некорректные названия городов), добавь новые методы.

- Убедись, что сервис корректно реагирует на различные сценарии. Добавь обработку ошибок, возникающих при запросах к API (например, недоступность API, проблемы с сетью).

- Выведи пользователю понятные сообщения об ошибках, чтобы он мог исправить свои действия (например, "Упс. Неверно введён город", "Ошибка подключения к серверу").

<!-- **Ответь на вопросы:**

1. Какие ошибки могут возникать при работе веб-сервиса?

2. Как лучше всего обрабатывать и отображать ошибки пользователю?

3. Как протестировать работу веб-сервиса с учётом всех возможных сценариев? -->



### **Критерии оценки**

1. **Проведение тестирования — 8 баллов:**

  - Веб-сервис протестирован на различных сценариях ввода данных.

  - Все компоненты работают корректно или выявлены ошибки.

2. **Реализация обработки ошибок — 8 баллов:**

	- Реализована обработка ошибок ввода данных и взаимодействия с API.

	- Сервис корректно сообщает об ошибках пользователю.

3. **Отображение сообщений об ошибках — 4 балла:**
  - Пользователь получает понятные и информативные сообщения об ошибках.

Максимальный балл за задание — **20 баллов.**

